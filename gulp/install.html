<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="format-detection" content="telephone=no" /> <!-- 禁止将数字变成电话号码 -->
    <meta content="yes" name="apple-mobile-web-app-capable"><!-- 允许全屏模式浏览，隐藏浏览器导航栏 -->
    <meta content="yes" name="apple-touch-fullscreen">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="theme-color" content="#91D4DA">
    <title>安装Gulp</title>
    <link href="../static/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../static/css/normalize.css" rel="stylesheet" />
    <link href="install.css" rel="stylesheet" />
</head>
<body>
<div class="container">
    <div class="main">
        <article>
            <h1>了解Gulp</h1>
            <div>
                gulp是部署代码工具(合并，压缩，加密，编译，语法检查等),
                gulp运行环境依赖node.js,因此需要先安装node.js。
            </div>
            <h3>安装gulp</h3>
            <h3>1. 创建一个文件夹，进入。</h3>
            <h3>2. 全局安装</h3>
            <p>Gulp需要先全局安装，然后在项目开发目录中安装为本地模块，进入目录执行下面命令: </p>
            <pre>npm install -gloabal gulp</pre>
            <pre>npm install --save-dev gulp</pre>
            <h3>3.验证是否安装成功</h3>
            <pre>gulp -v  // 查看版本号</pre>
        </article>
        <article>
            <h3>Gulp基本语法</h3>
            <p>项目中gulpfile.js是配置文件，下面是在gulpfile.js中的试例</p>
            <pre>
                var gulp = require("gulp");
                var uglify = require("gulp-uglify");

                gulp.task("minify", function(){
                    gulp.src("js/app.js")
                    .pipe(uglify())
                    .pipe(gulp.dest("build"))
                })
            </pre>
            <p>上面代码中，gulpfile.js加载gulp和gulp-uglify模块之后，使用gulp模块的task方法指定任务minify。task方法有两个参数，第一个是任务名，第二个是任务函数。在任务函数中，使用gulp模块的src方法，指定所要处理的文件，然后使用pipe方法，将上一步的输出转为当前的输入，进行链式处理。</p>
            <p>task方法的回调函数使用了两次pipe方法，也就是说做了两种处理。第一种处理是使用gulp-uglify模块，压缩源码；第二种处理是使用gulp模块的dest方法，将上一步的输出写入本地文件，这里是build.js（代码中省略了后缀名js）。</p>

            <h3>src语法: </h3>
            <p>gulp模块的src方法，用于产生数据流。它的参数表示所要处理的文件，这些指定的文件会转换成数据流</p>
            <pre>
                js/app.js：指定确切的文件名。
                js/*.js：某个目录所有后缀名为js的文件。
                js/**/*.js：某个目录及其所有子目录中的所有后缀名为js的文件。
                !js/app.js：除了js/app.js以外的所有文件。

                gulp.src(['js/**/*.js', '!js/**/*.min.js'])
            </pre>

            <h3>dest语法: </h3>
            <p>
                dest方法将管道的输出写入文件，同时将这些输出继续输出，
                所以可以依次调用多次dest方法，将输出写入多个目录。
                如果有目录不存在，将会被新建.
            </p>
            <pre>
                gulp.src('./client/templates/*.jade')
                .pipe(jade())
                .pipe(gulp.dest('./build/templates'))
                .pipe(minify())
                .pipe(gulp.dest('./build/minified_templates'));
            </pre>
            <p>dest方法还可以接受第二个参数，表示配置对象。</p>
            <pre>
                gulp.dest('build', {
                    cwd: './app',
                    mode: '0644'
                })
            </pre>

            <h3>task语法: </h3>
            <p>
                task方法用于定义具体的任务。它的第一个参数是任务名，第二个参数是任务函数。下面是一个非常简单的任务函数。
            </p>
            <pre>
                gulp.task('greet', function () {
                    console.log('Hello world!');
                });
            </pre>
            <p>task方法还可以指定按顺序运行的一组任务。</p>
            <pre>
                gulp.task('build', ['css', 'js', 'imgs']);
            </pre>

            <h3>watch语法: </h3>
            <p>
                watch方法用于指定需要监视的文件。一旦这些文件发生变动，就运行指定任务。
            </p>
            <pre>
                gulp.task('watch', function () {
                    gulp.watch('templates/*.tmpl.html', ['build']);
                    });
            </pre>
            <p>上面代码指定，一旦templates目录中的模板文件发生变化，就运行build任务。</p>

            <p>watch方法也可以用回调函数，代替指定的任务。</p>
            <pre>
                gulp.watch('templates/*.tmpl.html', function (event) {
                    console.log('Event type: ' + event.type);
                    console.log('Event path: ' + event.path);
                });
            </pre>
            <p>
                另一种写法是watch方法所监控的文件发生变化时（修改、增加、删除文件），
                会触发change事件。可以对change事件指定回调函数。
            </p>
            <pre>
                var watcher = gulp.watch('templates/*.tmpl.html', ['build']);
                watcher.on('change', function (event) {
                    console.log('Event type: ' + event.type);
                    console.log('Event path: ' + event.path);
                });
            </pre>
        </article>

        <article>
            <h1>使用gulp</h1>
            <h3>1. 查看web文件包</h3>
            <p>
                node_modules/<br>
                gulpfile.js<br>
            </p>
            <h3>2. 在gulpfile.js中可能会使用的插件</h3>
            <pre name="code">
                var gulp = require("gulp");
                imagemin = require('gulp-imagemin'),        //图片压缩
                sass = require('gulp-ruby-sass'),          //sass
                minifycss = require('gulp-minify-css'),    //css压缩
                jshint = require('gulp-jshint'),           //js检查
                uglify = require('gulp-uglify'),          //js压缩
                rename = require('gulp-rename'),           //重命名
                concat = require('gulp-concat'),          //合并文件
                clean = require('gulp-clean');            //清空文件夹
                htmlmin = require('gulp-htmlmin'),        //html 处理
                livereload = require('gulp-livereload'),  //自动刷新浏览器
                var fileinclude  = require('gulp-file-include');
            </pre>
			<h3>3. 进入项目目录，安装对应的的gulp插件</h3>
			<p>二.安装gulp-connect插件</p>
			<pre>
                npm install
                gulp-minify-css
                gulp-concat
                gulp-uglify
                gulp-imagemin
                gulp-clean
                gulp-rename
                gulp-htmlmin
                gulp-file-include --save-de
            </pre>
			<p>三.安装gulp-livereload插件</p>
			<pre>   npm install gulp-livereload  // 这个插件是自动刷新用的</pre>
			<h2>编写gulpfile.js文件</h2>
			<h4>想让工作更轻松更自动，就要好好写gulpfile.js</h4>

            <pre name="code">var gulp = require("gulp");
                var conncet = require("gulp-connect"); // 静态服务
                var livereload = require("gulp-livereload"); // 自动刷新
            </pre>
			<h2>2. 启动静态服务器</h2>
            //使用connect启动一个web服务器
            <pre name="code">

                gulp.task("startServer", function () {  // 任务名称不要有空格
                    conncet.server({
                        liverload:true,port: 9000  // 自动刷新，端口号：9000
                    });
                });
            </pre>
            <h2>3. 编写默认任务</h2>
            <pre>
                // 默认任务
                gulp.task("default", function() {
                    gulp.start("startServer");  //启动一个web服务器
                });
                gulp每次启动的时候（在控制台写gulp）都会运行默认任务
            </pre>
            <h2>4. 完成半自动化</h2>
            <pre>
                gulp.task("qinghuancun", function() {
                    // 清除缓存，或者说，重新加载所有html文件
                    gulp.src("*.html")
                        .pipe(connect.reload());
                });

                // gulp.src(globs[,options]);
                // 输出（Emits）符合所提供的匹配模式的文件。
            </pre>
            <h2>5. 监听html文件</h2>
            <pre>
                gulp.task("watchHtml", function() {
                    //监听所有html文件，如果有变化，则执行清除缓存方法
                    gulp.watch(["*.html"], ["html"]);
                }
            </pre>
            <h2>6. 把监听任务追加到启动服务器任务中</h2>
            <p>新建一个任务列表，把监听任务与服务器任务放在列表中</p>
            <pre>
                gulp.task("taskList", ["startServer", "watchHtml"]);
                gulp.task("default", function() {  //修改默认任务
                    gulp.start("taskList");  //执行任务列表
                });
            </pre>
            <h2>7. 查看内容</h2>
            <pre>
                //命令行输入 gulp
                //进入http://loaclhost:9000查看index.html内容
            </pre>
        </article>




    </div>
</div>
<footer>
    @2017 unatang
</footer>


</body>
<script src="static/js/jquery.min.js"></script>
<script src="static/js/bootstrap.min.js"></script>
</html>